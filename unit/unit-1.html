<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端自动化测试（一） | 珠峰架构课</title>
    <meta name="description" content="前端技术">
    
    
    <link rel="preload" href="/assets/css/0.styles.4cbd323c.css" as="style"><link rel="preload" href="/assets/js/app.1b92515e.js" as="script"><link rel="preload" href="/assets/js/2.370e7e65.js" as="script"><link rel="preload" href="/assets/js/40.f55a00d4.js" as="script"><link rel="prefetch" href="/assets/js/10.a21a18c5.js"><link rel="prefetch" href="/assets/js/11.21788e04.js"><link rel="prefetch" href="/assets/js/12.dee63b0f.js"><link rel="prefetch" href="/assets/js/13.6e202dde.js"><link rel="prefetch" href="/assets/js/14.40641029.js"><link rel="prefetch" href="/assets/js/15.5300bc30.js"><link rel="prefetch" href="/assets/js/16.f97f1c69.js"><link rel="prefetch" href="/assets/js/17.ffcff957.js"><link rel="prefetch" href="/assets/js/18.37d9114d.js"><link rel="prefetch" href="/assets/js/19.dd47af39.js"><link rel="prefetch" href="/assets/js/20.9df3ac40.js"><link rel="prefetch" href="/assets/js/21.fd093493.js"><link rel="prefetch" href="/assets/js/22.03c8d059.js"><link rel="prefetch" href="/assets/js/23.cce4b95f.js"><link rel="prefetch" href="/assets/js/24.085e6587.js"><link rel="prefetch" href="/assets/js/25.34a54844.js"><link rel="prefetch" href="/assets/js/26.437dd587.js"><link rel="prefetch" href="/assets/js/27.8d500bac.js"><link rel="prefetch" href="/assets/js/28.e4bc7dd0.js"><link rel="prefetch" href="/assets/js/29.4d85bcee.js"><link rel="prefetch" href="/assets/js/3.1cacdac7.js"><link rel="prefetch" href="/assets/js/30.8d1ee13d.js"><link rel="prefetch" href="/assets/js/31.0b3c5fdd.js"><link rel="prefetch" href="/assets/js/32.e5bbe7c4.js"><link rel="prefetch" href="/assets/js/33.7eb36ae2.js"><link rel="prefetch" href="/assets/js/34.b88e55f0.js"><link rel="prefetch" href="/assets/js/35.9d5c408a.js"><link rel="prefetch" href="/assets/js/36.27459212.js"><link rel="prefetch" href="/assets/js/37.7c0f4d16.js"><link rel="prefetch" href="/assets/js/38.a3a27b20.js"><link rel="prefetch" href="/assets/js/39.fdf02e73.js"><link rel="prefetch" href="/assets/js/4.6baae568.js"><link rel="prefetch" href="/assets/js/41.5369bfd1.js"><link rel="prefetch" href="/assets/js/42.7b20dcfa.js"><link rel="prefetch" href="/assets/js/43.1e198e47.js"><link rel="prefetch" href="/assets/js/44.94c47fc4.js"><link rel="prefetch" href="/assets/js/45.1b2fa0d2.js"><link rel="prefetch" href="/assets/js/46.3cd24b59.js"><link rel="prefetch" href="/assets/js/47.7c4aa349.js"><link rel="prefetch" href="/assets/js/48.ab2d6e5f.js"><link rel="prefetch" href="/assets/js/49.b715833f.js"><link rel="prefetch" href="/assets/js/5.a5c1265f.js"><link rel="prefetch" href="/assets/js/50.b636e4a0.js"><link rel="prefetch" href="/assets/js/51.82d9355c.js"><link rel="prefetch" href="/assets/js/52.e3626f37.js"><link rel="prefetch" href="/assets/js/53.b98d79d2.js"><link rel="prefetch" href="/assets/js/54.5ffe5351.js"><link rel="prefetch" href="/assets/js/55.22898f7b.js"><link rel="prefetch" href="/assets/js/56.0002a287.js"><link rel="prefetch" href="/assets/js/57.08ab88a9.js"><link rel="prefetch" href="/assets/js/58.a199fa5e.js"><link rel="prefetch" href="/assets/js/59.76596f2e.js"><link rel="prefetch" href="/assets/js/6.ef8139bd.js"><link rel="prefetch" href="/assets/js/60.af020deb.js"><link rel="prefetch" href="/assets/js/61.fcd987e7.js"><link rel="prefetch" href="/assets/js/7.d40030ec.js"><link rel="prefetch" href="/assets/js/8.5288b31e.js"><link rel="prefetch" href="/assets/js/9.7569e6b6.js">
    <link rel="stylesheet" href="/assets/css/0.styles.4cbd323c.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">珠峰架构课</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术分类</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">TypeScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">精品公开课</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/public/pwa.html" class="nav-link">玩转PWA</a></li><li class="dropdown-item"><!----> <a href="/public/vuex.html" class="nav-link">vuex原理</a></li><li class="dropdown-item"><!----> <a href="/public/vue-ssr.html" class="nav-link">vue-ssr原理</a></li><li class="dropdown-item"><!----> <a href="/public/cli.html" class="nav-link">实现通用脚手架</a></li><li class="dropdown-item"><!----> <a href="/unit/unit-1.html" class="nav-link router-link-exact-active router-link-active">单元测试</a></li><li class="dropdown-item"><!----> <a href="/webpack/note-1.html" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/uni-app/note-1.html" class="nav-link">uni-app</a></li><li class="dropdown-item"><!----> <a href="/public/vue3.0.html" class="nav-link">剖析vue3.0</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JS核心</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js-core/js-1.html" class="nav-link">js基础概念</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">VUE训练营</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-info/component.html" class="nav-link">vue组件间通信</a></li><li class="dropdown-item"><!----> <a href="/vue-info/jsx.html" class="nav-link">jsx渲染函数</a></li><li class="dropdown-item"><!----> <a href="/vue-info/jwt.html" class="nav-link">JWT认证</a></li><li class="dropdown-item"><!----> <a href="/vue-info/cascader.html" class="nav-link">级联组件的编写</a></li><li class="dropdown-item"><!----> <a href="/vue-info/unit.html" class="nav-link">单元测试</a></li><li class="dropdown-item"><!----> <a href="/vue-info/auth.html" class="nav-link">vue权限</a></li><li class="dropdown-item"><!----> <a href="/vue-info/vue-router.html" class="nav-link">实现路由和状态管理</a></li><li class="dropdown-item"><!----> <a href="/vue-info/source.html" class="nav-link">vue原理剖析</a></li><li class="dropdown-item"><!----> <a href="/vue-info/optimize.html" class="nav-link">Vue相关优化</a></li><li class="dropdown-item"><!----> <a href="/vue-info/vue+ts.html" class="nav-link">Vue+TypeScript</a></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">技术分类</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/typescript/" class="nav-link">TypeScript</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">精品公开课</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/public/pwa.html" class="nav-link">玩转PWA</a></li><li class="dropdown-item"><!----> <a href="/public/vuex.html" class="nav-link">vuex原理</a></li><li class="dropdown-item"><!----> <a href="/public/vue-ssr.html" class="nav-link">vue-ssr原理</a></li><li class="dropdown-item"><!----> <a href="/public/cli.html" class="nav-link">实现通用脚手架</a></li><li class="dropdown-item"><!----> <a href="/unit/unit-1.html" class="nav-link router-link-exact-active router-link-active">单元测试</a></li><li class="dropdown-item"><!----> <a href="/webpack/note-1.html" class="nav-link">webpack</a></li><li class="dropdown-item"><!----> <a href="/uni-app/note-1.html" class="nav-link">uni-app</a></li><li class="dropdown-item"><!----> <a href="/public/vue3.0.html" class="nav-link">剖析vue3.0</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">JS核心</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/js-core/js-1.html" class="nav-link">js基础概念</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">VUE训练营</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/vue-info/component.html" class="nav-link">vue组件间通信</a></li><li class="dropdown-item"><!----> <a href="/vue-info/jsx.html" class="nav-link">jsx渲染函数</a></li><li class="dropdown-item"><!----> <a href="/vue-info/jwt.html" class="nav-link">JWT认证</a></li><li class="dropdown-item"><!----> <a href="/vue-info/cascader.html" class="nav-link">级联组件的编写</a></li><li class="dropdown-item"><!----> <a href="/vue-info/unit.html" class="nav-link">单元测试</a></li><li class="dropdown-item"><!----> <a href="/vue-info/auth.html" class="nav-link">vue权限</a></li><li class="dropdown-item"><!----> <a href="/vue-info/vue-router.html" class="nav-link">实现路由和状态管理</a></li><li class="dropdown-item"><!----> <a href="/vue-info/source.html" class="nav-link">vue原理剖析</a></li><li class="dropdown-item"><!----> <a href="/vue-info/optimize.html" class="nav-link">Vue相关优化</a></li><li class="dropdown-item"><!----> <a href="/vue-info/vue+ts.html" class="nav-link">Vue+TypeScript</a></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/unit/unit-1.html" class="active sidebar-link">前端自动化测试（一）</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_1-测试" class="sidebar-link">1.测试</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_1-1-黑盒测试和白盒测试" class="sidebar-link">1.1 黑盒测试和白盒测试</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_1-2-测试分类" class="sidebar-link">1.2 测试分类</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_1-3-tdd-bdd" class="sidebar-link">1.3 TDD &amp; BDD</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_1-4-测试框架" class="sidebar-link">1.4 测试框架</a></li></ul></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_2-jest的核心应用" class="sidebar-link">2.Jest的核心应用</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_2-1-分组、用例" class="sidebar-link">2.1 分组、用例</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_2-2-matchers匹配器" class="sidebar-link">2.2 matchers匹配器</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_2-3-测试操作节点方法" class="sidebar-link">2.3 测试操作节点方法</a></li><li class="sidebar-sub-header"><a href="/unit/unit-1.html#_2-4-jest常用命令" class="sidebar-link">2.4 Jest常用命令</a></li></ul></li></ul></li><li><a href="/unit/unit-2.html" class="sidebar-link">前端自动化测试（二）</a></li><li><a href="/unit/unit-3.html" class="sidebar-link">前端自动化测试（三）</a></li><li><a href="/unit/unit-4.html" class="sidebar-link">前端自动化测试（四）</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="前端自动化测试（一）"><a href="#前端自动化测试（一）" aria-hidden="true" class="header-anchor">#</a> 前端自动化测试（一）</h1> <p>目前开发大型应用，测试是一个非常重要的环节，但是大多数前端开发者对测试相关的知识是比较缺乏的，因为可能项目开发周期短根本没有机会写。所以你没有办法体会到前端自动化测试的重要性！</p> <p>来说说为什么前端自动化测试如此重要！</p> <p>先看看前端常见的问题:</p> <ul><li>修改某个模块功能时，其它模块也受影响，很难快速定位bug</li> <li>多人开发代码越来越难以维护</li> <li>不方便迭代,代码无法重构</li> <li>代码质量差</li></ul> <p>增加自动化测试后：</p> <ul><li>我们为核心功能编写测试后可以保障项目的可靠性</li> <li>强迫开发者,编写更容易被测试的代码，提高代码质量</li> <li>编写的测试有文档的作用，方便维护</li></ul> <h2 id="_1-测试"><a href="#_1-测试" aria-hidden="true" class="header-anchor">#</a> 1.测试</h2> <h3 id="_1-1-黑盒测试和白盒测试"><a href="#_1-1-黑盒测试和白盒测试" aria-hidden="true" class="header-anchor">#</a> 1.1 黑盒测试和白盒测试</h3> <ul><li><p>黑盒测试一般也被称为功能测试，黑盒测试要求测试人员将程序看作一个整体，不考虑其内部结构和特性，只是按照期望验证程序是否能正常工作</p></li> <li><p>白盒测试是基于代码本身的测试，一般指对代码逻辑结构的测试。</p></li></ul> <h3 id="_1-2-测试分类"><a href="#_1-2-测试分类" aria-hidden="true" class="header-anchor">#</a> 1.2 测试分类</h3> <p><code>单元测试(Unit Testing)</code></p> <p>单元测试是指对程序中最小可测试单元进行的测试,例如测试<code>一个函数</code>、<code>一个模块</code>、<code>一个组件</code>...</p> <p><code>集成测试(Integration Testing)</code></p> <p>将已测试过的单元测试函数进行组合集成暴露出的高层函数或类的封装，对这些函数或类进行的测试</p> <p><code>端到端测试(E2E Testing)</code>
打开应用程序模拟输入，检查功能以及界面是否正确</p> <h3 id="_1-3-tdd-bdd"><a href="#_1-3-tdd-bdd" aria-hidden="true" class="header-anchor">#</a> 1.3 TDD &amp; BDD</h3> <p><code>TDD是测试驱动开发(Test-Driven Development)</code></p> <p>TDD的原理是在开发功能代码之前，先编写单元测试用例代码</p> <p><code>BDD是行为驱动开发(Behavior-Driven Development)</code></p> <p>系统业务专家、开发者、测试人员一起合作，分析软件的需求，然后将这些需求写成一个个的故事。开发者负责填充这些故事的内容,保证程序实现效果与用户需求一致。</p> <p>总结：
TDD是先写测试在开发 （一般都是单元测试，白盒测试），而BDD则是按照用户的行为来开发，在根据用户的行为编写测试用例 （一般都是集成测试，黑盒测试）</p> <h3 id="_1-4-测试框架"><a href="#_1-4-测试框架" aria-hidden="true" class="header-anchor">#</a> 1.4 测试框架</h3> <ul><li><strong>Karma</strong> Karma为前端自动化测试提供了跨浏览器测试的能力，可以在浏览器中执行测试用例</li> <li><strong>Mocha</strong> 前端自动化测试框架,需要配合其他库一起使用，像chai、sinon...</li> <li><strong>Jest</strong>  Jest 是facebook推出的一款测试框架,集成了 Mocha,chai,jsdom,sinon等功能。</li> <li>...</li></ul> <p>看到这<code>facebook</code> 都在推Jest,你还不学吗? Jest也有一些缺陷就是不能像<code>karam</code>这样直接跑早浏览器上，它采用的是<code>jsdom</code>，优势是简单、0配置！ 后续我们通过jest来聊前端自动化测试</p> <h2 id="_2-jest的核心应用"><a href="#_2-jest的核心应用" aria-hidden="true" class="header-anchor">#</a> 2.Jest的核心应用</h2> <p>在说<code>Jest</code>测试之前，先来看看以前我们是怎样测试的</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">const</span> <span class="token function-variable function">parser</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">str</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> obj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
    str<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token regex">/([^&amp;=]*)=([^&amp;=]*)/g</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span>
        obj<span class="token punctuation">[</span>arguments<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span> <span class="token operator">=</span> arguments<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> obj<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token keyword">const</span> <span class="token function-variable function">stringify</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">obj</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token keyword">const</span> arr <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token keyword">let</span> key <span class="token keyword">in</span> obj<span class="token punctuation">)</span><span class="token punctuation">{</span>
        arr<span class="token punctuation">.</span><span class="token function">push</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>key<span class="token interpolation-punctuation punctuation">}</span></span><span class="token string">=</span><span class="token interpolation"><span class="token interpolation-punctuation punctuation">${</span>obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span><span class="token interpolation-punctuation punctuation">}</span></span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token keyword">return</span> arr<span class="token punctuation">.</span><span class="token function">join</span><span class="token punctuation">(</span><span class="token string">'&amp;'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token comment">// console.log(parser('name=zf')); // {name:'zf'}</span>
<span class="token comment">// console.log(stringify({name:'zf'})) // name=zf</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br></div></div><p>我们每写完一个功能，会先手动测试功能是否正常，测试后可能会将测试代码注释起来。这样会产生一系列问题，因为会污染源代码，所有的测试代码和源代码混合在一起。如果删除掉，下次测试还需要重新编写。</p> <p>所以测试框架就帮我们解决了上述的问题</p> <h3 id="_2-1-分组、用例"><a href="#_2-1-分组、用例" aria-hidden="true" class="header-anchor">#</a> 2.1 分组、用例</h3> <p>Jest是基于模块的，我们需要将代码包装成模块的方式,分别使用 <code>export</code> 将 <code>parser</code>、<code>stringify</code>这两个方法导出</p> <p>安装<code>jest</code></p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token function">npm</span> init -y <span class="token comment"># 初始化pacakge.json</span>
<span class="token function">npm</span> i jest 
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>我们建立一个<code>qs.test.js</code>来专门编写测试用例，这里的用例你可以认为就是一条测试功能 （后缀要以.test.js结尾，这样jest测试时默认会调用这个文件）</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>parser<span class="token punctuation">,</span>stringify<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./qs'</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试 parser 是否能正常解析结果'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token comment">// expect 断言，判断解析出来的结果是否和 {name:'zf'}相等</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name=zf</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'zf'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p><code>jest</code>默认自带断言功能，断言的意思就是判断是不是这个样子，我断定你今天没吃饭~，结果你吃了。说明这次断言就失败了，测试就无法通过</p> <p>通过配置<code>scripts</code> 来执行命令</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>执行 <code>npm run test</code>,可惜的是默认在<code>node</code>环境下不支持<code>es6模块</code>的语法，需要<code>babel</code>转义,当然你也可以直接使用commonjs规范来导出方法，因为大多数现在开发都采用es6模块，所以就安装一下~</p> <div class="language-bash line-numbers-mode"><pre class="language-bash"><code><span class="token comment"># core是babel的核心包 preset-env将es6转化成es5</span>
<span class="token function">npm</span> i @babel/core @babel/preset-env --save-dev
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>并且配置<code>.babelrc</code>文件，告诉babel用什么来转义</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token punctuation">{</span>
    <span class="token property">&quot;presets&quot;</span><span class="token operator">:</span><span class="token punctuation">[</span>
        <span class="token punctuation">[</span>
            <span class="token string">&quot;@babel/preset-env&quot;</span><span class="token punctuation">,</span><span class="token punctuation">{</span>
                <span class="token property">&quot;targets&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span><span class="token property">&quot;node&quot;</span><span class="token operator">:</span><span class="token string">&quot;current&quot;</span><span class="token punctuation">}</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">]</span>
    <span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>默认jest中集成了<code>babel-jest</code>,运行时默认会调用<code>.babelrc</code>进行转义，可以直接将es6转成es5语法<br>
运行 <code>npm run test</code> 出现:</p> <p><img src="http://img.fullstackjavascript.cn/unit1.png" alt=""></p> <p>继续编写第二个用例</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span>parser<span class="token punctuation">,</span>stringify<span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./qs'</span><span class="token punctuation">;</span>
<span class="token function">describe</span><span class="token punctuation">(</span><span class="token string">'测试qs 库'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试 parser 是否能正常解析结果'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">parser</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name=zf</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'zf'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
    
    <span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试 stringify 是否正常使用stringify'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
        <span class="token function">expect</span><span class="token punctuation">(</span><span class="token function">stringify</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'zf'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">name=zf</span><span class="token template-punctuation string">`</span></span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><blockquote><p>describe的功能是给用例分组，这样可以更好的给用例分类，其实这就是我们所谓的单元测试，对某个具体函数和功能进行测试</p></blockquote> <h3 id="_2-2-matchers匹配器"><a href="#_2-2-matchers匹配器" aria-hidden="true" class="header-anchor">#</a> 2.2 matchers匹配器</h3> <p>在写第一个测试用例时，我们一直在使用<code>toEqual</code>其实这就是一个匹配器，那我们来看看<code>jest</code>中常用的匹配器有哪些？因为匹配器太多了，所以我就讲些常用的！</p> <p>为了方便理解，我把匹配器分为三类、判断相等、不等、是否包含</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'判断是否相等'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 相等于 js中的===</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'zf'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toEqual</span><span class="token punctuation">(</span><span class="token punctuation">{</span>name<span class="token punctuation">:</span><span class="token string">'zf'</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 比较内容是否相等</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeTruthy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否为 true / false 也可以用toBe(true)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token boolean">false</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeFalsy</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'判断不相等关系'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBe</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// not取反</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeLessThan</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// js中的小于</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeGreaterThan</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// js中的大于</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'判断是否包含'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toContain</span><span class="token punctuation">(</span><span class="token string">'hello'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 是否包含</span>
    <span class="token function">expect</span><span class="token punctuation">(</span><span class="token string">'hello world'</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toMatch</span><span class="token punctuation">(</span><span class="token regex">/hello/</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 正则</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br></div></div><h3 id="_2-3-测试操作节点方法"><a href="#_2-3-测试操作节点方法" aria-hidden="true" class="header-anchor">#</a> 2.3 测试操作节点方法</h3> <p>说了半天，我们自己来写个功能测试一下!</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">export</span> <span class="token keyword">const</span> <span class="token function-variable function">removeNode</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token parameter">node</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
    node<span class="token punctuation">.</span>parentNode<span class="token punctuation">.</span><span class="token function">removeChild</span><span class="token punctuation">(</span>node<span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>核心就是测试传入一个节点，这个节点是否能从<code>DOM</code>中删除</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">import</span> <span class="token punctuation">{</span> removeNode <span class="token punctuation">}</span> <span class="token keyword">from</span> <span class="token string">'./dom'</span>
<span class="token function">it</span><span class="token punctuation">(</span><span class="token string">'测试删除节点'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">=&gt;</span><span class="token punctuation">{</span>
    document<span class="token punctuation">.</span>body<span class="token punctuation">.</span>innerHTML <span class="token operator">=</span> <span class="token template-string"><span class="token template-punctuation string">`</span><span class="token string">&lt;div&gt;&lt;button data-btn=&quot;btn&quot;&gt;&lt;/button&lt;/div&gt;</span><span class="token template-punctuation string">`</span></span>
    <span class="token keyword">let</span> btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'[data-btn=&quot;btn&quot;]'</span><span class="token punctuation">)</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span><span class="token punctuation">.</span>not<span class="token punctuation">.</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">removeNode</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span><span class="token punctuation">;</span>
    btn <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'[data-btn=&quot;btn&quot;]'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">expect</span><span class="token punctuation">(</span>btn<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toBeNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p>这个就是我们所说的jsdom，在node中操作dom元素</p> <h3 id="_2-4-jest常用命令"><a href="#_2-4-jest常用命令" aria-hidden="true" class="header-anchor">#</a> 2.4 Jest常用命令</h3> <p>我们希望每次更改测试后，自动重新执行测试,修改执行命令:</p> <div class="language-json line-numbers-mode"><pre class="language-json"><code><span class="token property">&quot;scripts&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
    <span class="token property">&quot;test&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jest --watchAll&quot;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>重新执行 <code>npm run test</code>，这时就会监控用户的修改
<img src="http://img.fullstackjavascript.cn/unit2.png" alt=""></p> <p>提示我们按下<code>w</code>，显示更多信息</p> <p><img src="http://img.fullstackjavascript.cn/unit3.png" alt=""></p> <p>这里我把每个命令的含义都列好了，有需要可以自己尝试一下~</p></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/unit/unit-2.html">前端自动化测试（二）</a>→
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.1b92515e.js" defer></script><script src="/assets/js/2.370e7e65.js" defer></script><script src="/assets/js/40.f55a00d4.js" defer></script>
  </body>
</html>
